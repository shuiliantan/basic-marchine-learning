# K-means聚类

## 原理

对于给定的样本集，按照样本间的距离大小，将样本分为k个类。让簇内点的距离尽可能的小，簇间的距离尽可能远。

**算法流程**

```
选取k个点作为质心
repeat
	将每个点指派到最近的质心，形成k个簇
	重新计算每个簇的质心
util 簇不发生变化 或者达到迭代次数
```

### 损失函数

最小化所有数据到聚类中心的欧式距离和的平均值，即

$$J=\frac{1}{m}\sum_{i=1}^m(x_i-u_{c^(i)})^2$$

其中$$x_i$$为数据点，$$u_{c^(i)}$$代表$$x_i$$所属的聚类中心



### 收敛条件

- 达到max-iter
- 损失函数达到阈值tol 
- 簇不再发生变化

### 超参数

　KMeans类的主要参数有：

- **n_clusters**: k值，一般需要多试一些值以获得较好的聚类效果。

- **max_iter**： 最大的迭代次数。一般如果是凸数据集的话可以不管这个值，如果数据集不是凸的，可能很难收敛，此时可以指定最大的迭代次数让算法可以及时退出循环。

- **n_init：**用不同的初始化质心运行算法的次数。由于K-Means是结果受初始值影响的局部最优的迭代算法，因此需要多跑几次以选择一个较好的聚类效果，默认是10，一般不需要改。如果你的k值较大，则可以适当增大这个值。
- **init：** 即初始值选择的方式，default='k-means++'
  - 'random'：完全随机选择；
  - 'k-means++'：优化过的，可以加速收敛。
  - ndarray：自己指定初始化的k个质心。
- **algorithm**：有“auto”, “full” or “elkan”三种选择，默认为‘auto’
  - "full"：传统的K-Means算法;
  -  “elkan”：elkan K-Means算法。
  - "auto"：根据数据值是否是稀疏的，来决定如何选择"full"和“elkan”。一般数据是稠密的，那么就是 “elkan”，否则就是"full"。

### 评估标准

让簇内点的距离尽可能的小，簇间的距离尽可能远。

### 算法使用注意项

- 对缺失值异常值敏感，因为数据中的异常值能明显改变不同点之间的距离
- 需要归一化：需要将不同量纲的数据标准化